Fri Jan 16 14:50:44 CET 2026
NVIDIA H100
W0116 14:50:48.572494 1864642 cuda_executor.cc:1802] GPU interconnect information not available: INTERNAL: NVML doesn't support extracting fabric info or NVLink is not used by the device.
W0116 14:50:48.578876 1864589 cuda_executor.cc:1802] GPU interconnect information not available: INTERNAL: NVML doesn't support extracting fabric info or NVLink is not used by the device.
14:50 ninjax INFO    : Checking and setting outdir
14:50 ninjax INFO    : The outdir is set to .
14:50 ninjax INFO    : Loading the given config
14:50 ninjax INFO    : Arguments loaded into the config: {'likelihood': 'HeterodynedPhaseMarginalizedLikelihoodFD', 'gw_injection': 'True', 'gw_load_existing_injection': 'True', 'gw_SNR_threshold_low': '20', 'gw_SNR_threshold_high': '50', 'gw_max_injection_attempts': '20', 'waveform_approximant': 'TaylorF2', 'ifos': 'H1,L1,V1', 'eos_file': 'None', 'center_chirp_mass_prior': 'True', 'chirp_mass_prior_delta': '0.10', 'fmin': '20.0', 'fref': '20.0', 'fmax': '2048.0', 'duration': 'None', 'post_trigger_duration': '2.0', 'trigger_time': '1187008882.4', 'psd_file_H1': 'AplusDesign_PSD.txt', 'psd_file_L1': 'AplusDesign_PSD.txt', 'psd_file_V1': 'AdV_psd.txt', 'psd_file_ET1': '/home/twouters2/psds/ET_D_psd.txt', 'psd_file_ET2': '/home/twouters2/psds/ET_D_psd.txt', 'psd_file_ET3': '/home/twouters2/psds/ET_D_psd.txt', 'psd_file_CE': '/home/twouters2/psds/CE_psd.txt', 'data_file_H1': 'None', 'data_file_L1': 'None', 'data_file_V1': 'None', 'data_file_ET1': 'None', 'data_file_ET2': 'None', 'data_file_ET3': 'None', 'relative_binning_binsize': '500', 'relative_binning_ref_params_equal_true_params': 'True', 'relative_binning_ref_params': 'None', 'transforms': 'None', 'gw_kwargs': 'None', 'sampler_type': 'blackjax-ns-aw', 'n_chains': '1000', 'n_local_steps': '100', 'n_global_steps': '1000', 'n_training_loops': '20', 'n_production_loops': '10', 'n_epochs': '20', 'mala_step_size': '2e-3', 'mala_step_size_scale': 'None', 'chain_batch_size': '0', 'batch_size': '10000', 'n_max_examples': '30000', 'rq_spline_hidden_units': '128,128', 'rq_spline_n_bins': '10', 'rq_spline_n_layers': '8', 'learning_rate': '1e-3', 'local_thinning': '1', 'global_thinning': '100', 'n_NFproposal_batch_size': '100', 'history_window': '100', 'n_temperatures': '0', 'max_temperature': '10.0', 'n_tempered_steps': '5', 'verbose': 'True', 'save_training_chains': 'False', 'use_scheduler': 'True', 'seed': 'None', 'sampling_seed': '1', 'run_sampler': 'True', 'keys_to_plot': 'M_c, q, s1_z, s2_z, lambda_1, lambda_2, d_L, t_c, phase_c, iota, psi, ra, dec', 'blackjax_ns_aw_n_live': '1000', 'blackjax_ns_aw_n_delete_frac': '0.5', 'blackjax_ns_aw_n_target': '60', 'blackjax_ns_aw_max_mcmc': '5000', 'blackjax_ns_aw_max_proposals': '1000', 'blackjax_ns_aw_termination_dlogz': '0.1', 'blackjax_nss_n_live': '1000', 'blackjax_nss_n_delete_frac': '0.5', 'blackjax_nss_num_inner_steps': '50', 'blackjax_nss_termination_dlogz': '0.1', 'blackjax_smc_n_particles': '10000', 'blackjax_smc_n_mcmc_steps': '1000', 'blackjax_smc_target_ess': '0.9', 'blackjax_smc_scale_proposal': '0.01'}
14:50 ninjax INFO    : Complete config file written to /gpfs/home6/twouters2/projects/05_ninjax_injections/ninjax/examples/example_blackjax_ns_aw/complete_config.json
14:50 ninjax INFO    : No seed specified. Generating a random seed: 990532
14:50 ninjax INFO    : Loading the priors
14:50 ninjax INFO    :    Mc_prior = UniformPrior(1.0, 2.2, parameter_names=['M_c'])
14:50 ninjax INFO    :    q_prior = UniformPrior(0.5, 1.0, parameter_names=['q'])
14:50 ninjax INFO    :    s1z_prior = UniformPrior(-0.05, 0.05, parameter_names=['s1_z'])
14:50 ninjax INFO    :    s2z_prior = UniformPrior(-0.05, 0.05, parameter_names=['s2_z'])
14:50 ninjax INFO    :    lambda_1_prior = UniformPrior(0.0, 5000.0, parameter_names=['lambda_1'])
14:50 ninjax INFO    :    lambda_2_prior = UniformPrior(0.0, 5000.0, parameter_names=['lambda_2'])
14:50 ninjax INFO    :    dL_prior = PowerLawPrior(1.0, 200.0, 2.0, parameter_names=['d_L'])
14:50 ninjax INFO    :    tc_prior = UniformPrior(-0.1, 0.1, parameter_names=['t_c'])
14:50 ninjax INFO    :    phase_c_prior = UniformPrior(0.0, 2 * jnp.pi, parameter_names=['phase_c'])
14:50 ninjax INFO    :    iota_prior = SinePrior(parameter_names=["iota"])
14:50 ninjax INFO    :    psi_prior = UniformPrior(0.0, jnp.pi, parameter_names=["psi"])
14:50 ninjax INFO    :    ra_prior = UniformPrior(0.0, 2 * jnp.pi, parameter_names=["ra"])
14:50 ninjax INFO    :    dec_prior = CosinePrior(parameter_names=["dec"])
14:50 ninjax INFO    : Finished prior setup
14:50 ninjax INFO    : Setting the transforms
14:50 ninjax INFO    : Built sample_transforms pipeline for blackjax-ns-aw with 15 transforms
14:50 ninjax INFO    : Built likelihood_transforms pipeline with 1 transforms
14:50 ninjax INFO    : Setting the likelihood
14:50 ninjax INFO    : GW likelihood provided, setting up the GW pipe
14:50 ninjax INFO    : eos_file is None
14:50 ninjax INFO    : No eos_file specified. Will sample lambdas uniformly.
14:50 ninjax INFO    : GW run is an injection
14:50 ninjax INFO    : Setting up GW injection . . . 
14:50 ninjax INFO    : The SNR thresholds are: 20.0 - 50.0
14:50 ninjax INFO    : Maximum injection attempts allowed: 20
14:50 ninjax INFO    : Loading existing injection, path: ./injection.json
14:50 ninjax INFO    : Duration is not specified in the config. Computed chirp time: for fmin = 20.0 and M_c = 1.4 is 128.0
14:50 ninjax INFO    : After transforms, the injection parameters are:
14:50 ninjax INFO    : {'M_c': 1.4, 's1_z': 0.01, 's2_z': 0.02, 'lambda_1': 200.0, 'lambda_2': 500.0, 'd_L': 100.0, 't_c': -0.0895451428029396, 'phase_c': 3.8567087000372386, 'iota': 0.8337374361881844, 'psi': 2.634020274327402, 'ra': 5.446571919019908, 'dec': 0.93640500992398, 'H1_SNR': 33.886475817398065, 'L1_SNR': 22.943843283027437, 'V1_SNR': 11.062994866440132, 'network_SNR': 42.39225216161684, 'epoch': 126.0, 'gmst': 2.7288901910520846, 'trigger_time': 1187008882.4, 'duration': 128.0, 'eta': 0.24387917322593855}
14:50 ninjax INFO    : The trial injection parameters are {'M_c': 1.4, 's1_z': 0.01, 's2_z': 0.02, 'lambda_1': 200.0, 'lambda_2': 500.0, 'd_L': 100.0, 't_c': -0.0895451428029396, 'phase_c': 3.8567087000372386, 'iota': 0.8337374361881844, 'psi': 2.634020274327402, 'ra': 5.446571919019908, 'dec': 0.93640500992398, 'H1_SNR': 33.886475817398065, 'L1_SNR': 22.943843283027437, 'V1_SNR': 11.062994866440132, 'network_SNR': 42.39225216161684, 'epoch': 126.0, 'gmst': np.float64(2.7288901910520846), 'trigger_time': 1187008882.4, 'duration': 128.0, 'eta': 0.24387917322593855}
14:50 ninjax INFO    : Injecting signals . . .
14:50 ninjax INFO    : self.ifos
14:50 ninjax INFO    : [GroundBased2G(H1), GroundBased2G(L1), GroundBased2G(V1)]
14:50 ninjax INFO    : Loading PSD from file: /gpfs/home6/twouters2/projects/05_ninjax_injections/ninjax/src/ninjax/AplusDesign_PSD.txt
14:51 ninjax INFO    : Signal injected in ifo H1. Frequencies, data, and PSD:
14:51 ninjax INFO    : [0.00000000e+00 7.81250000e-03 1.56250000e-02 ... 2.04798438e+03
 2.04799219e+03 2.04800000e+03]
14:51 ninjax INFO    : Data(name='H1_injected', delta_t=0.000244140625, epoch=126.0)
14:51 ninjax INFO    : PowerSpectrum(name='H1_psd', frequencies=[0.00000000e+00 7.81250000e-03 1.56250000e-02 ... 2.04798438e+03
 2.04799219e+03 2.04800000e+03])
14:51 ninjax INFO    : Loading PSD from file: /gpfs/home6/twouters2/projects/05_ninjax_injections/ninjax/src/ninjax/AplusDesign_PSD.txt
14:51 ninjax INFO    : Signal injected in ifo L1. Frequencies, data, and PSD:
14:51 ninjax INFO    : [0.00000000e+00 7.81250000e-03 1.56250000e-02 ... 2.04798438e+03
 2.04799219e+03 2.04800000e+03]
14:51 ninjax INFO    : Data(name='L1_injected', delta_t=0.000244140625, epoch=126.0)
14:51 ninjax INFO    : PowerSpectrum(name='L1_psd', frequencies=[0.00000000e+00 7.81250000e-03 1.56250000e-02 ... 2.04798438e+03
 2.04799219e+03 2.04800000e+03])
14:51 ninjax INFO    : Loading PSD from file: /gpfs/home6/twouters2/projects/05_ninjax_injections/ninjax/src/ninjax/AdV_psd.txt
14:51 ninjax INFO    : Signal injected in ifo V1. Frequencies, data, and PSD:
14:51 ninjax INFO    : [0.00000000e+00 7.81250000e-03 1.56250000e-02 ... 2.04798438e+03
 2.04799219e+03 2.04800000e+03]
14:51 ninjax INFO    : Data(name='V1_injected', delta_t=0.000244140625, epoch=126.0)
14:51 ninjax INFO    : PowerSpectrum(name='V1_psd', frequencies=[0.00000000e+00 7.81250000e-03 1.56250000e-02 ... 2.04798438e+03
 2.04799219e+03 2.04800000e+03])
14:51 ninjax INFO    : SNR for ifo H1 is 33.886475817398065
14:51 ninjax INFO    : SNR for ifo L1 is 22.943843283027466
14:51 ninjax INFO    : SNR for ifo V1 is 11.062994866440137
14:51 ninjax INFO    : The network SNR is 42.39225216161686
14:51 ninjax INFO    : Network SNR passes threshold
14:51 ninjax INFO    : Sanity checking the GW injection for ArrayImpl
14:51 ninjax INFO    :    M_c: 1.4
14:51 ninjax INFO    :    q: 0.7293985440171007
14:51 ninjax INFO    :    s1_z: 0.01
14:51 ninjax INFO    :    s2_z: 0.02
14:51 ninjax INFO    :    lambda_1: 200.0
14:51 ninjax INFO    :    lambda_2: 500.0
14:51 ninjax INFO    :    d_L: 100.0
14:51 ninjax INFO    :    t_c: -0.0895451428029396
14:51 ninjax INFO    :    phase_c: 3.8567087000372386
14:51 ninjax INFO    :    iota: 0.8337374361881844
14:51 ninjax INFO    :    psi: 2.634020274327402
14:51 ninjax INFO    :    ra: 5.446571919019908
14:51 ninjax INFO    :    dec: 0.93640500992398
14:51 ninjax INFO    :    H1_SNR: 33.886475817398065
14:51 ninjax INFO    :    L1_SNR: 22.943843283027466
14:51 ninjax INFO    :    V1_SNR: 11.062994866440137
14:51 ninjax INFO    :    network_SNR: 42.39225216161686
14:51 ninjax INFO    :    epoch: 126.0
14:51 ninjax INFO    :    gmst: 2.7288901910520846
14:51 ninjax INFO    :    trigger_time: 1187008882.4
14:51 ninjax INFO    :    duration: 128.0
14:51 ninjax INFO    : Using GW HeterodynedPhaseMarginalizedLikelihoodFD (heterodyned + phase-marginalized). Initializing likelihood
14:51 ninjax INFO    : Using the injection parameters as reference parameters for the relative binning
14:51 ninjax INFO    : Using the following kwargs for the GW likelihood: {}
14:51 ninjax INFO    : Applying likelihood transforms to reference parameters
14:51 ninjax INFO    : Transformed ref_params keys: ['M_c', 's1_z', 's2_z', 'lambda_1', 'lambda_2', 'd_L', 't_c', 'phase_c', 'iota', 'psi', 'ra', 'dec', 'H1_SNR', 'L1_SNR', 'V1_SNR', 'network_SNR', 'epoch', 'gmst', 'trigger_time', 'duration', 'eta']
14:51 ninjax INFO    : Initialization of HeterodynedPhaseMarginalizedLikelihoodFD took 9.619186639785767 seconds = 0.16031977732976277 minutes
14:51 ninjax INFO    : Checking if chirp mass prior recentering is enabled
14:51 ninjax INFO    : Recentering chirp mass prior around injected value: M_c = 1.4
14:51 ninjax INFO    : New chirp mass prior bounds: [1.2999999999999998, 1.5] (delta = 0.1)
14:51 ninjax INFO    : Replaced M_c prior with centered prior: UniformPrior(1.2999999999999998, 1.5)
14:51 ninjax INFO    : Successfully recentered chirp mass prior
14:51 ninjax INFO    : Will plot these keys: ['M_c', 'q', 's1_z', 's2_z', 'lambda_1', 'lambda_2', 'd_L', 't_c', 'phase_c', 'iota', 'psi', 'ra', 'dec']
14:51 ninjax INFO    : Will plot the labels: ['$M_c/M_\\odot$', '$q$', '$\\chi_1$', '$\\chi_2$', '$\\Lambda_1$', '$\\Lambda_2$', '$d_{\\rm{L}}/{\\rm Mpc}$', '$t_c$', '$\\phi_c$', '$\\iota$', '$\\psi$', '$\\alpha$', '$\\delta$']
14:51 ninjax INFO    : Ninjax setup complete.
14:51 ninjax INFO    : Saving output to ./
14:51 ninjax INFO    : Using sampler: blackjax-ns-aw
/gpfs/home6/twouters2/projects/05_ninjax_injections/.venv/lib/python3.12/site-packages/jaxopt/_src/osqp.py:333: SyntaxWarning: invalid escape sequence '\m'
  Dual Ineq variables: :math:`\mu, \phi`
======================================================================
BlackJAX Nested Sampling (Acceptance Walk)
======================================================================
Configuration: 1000 live points, batch size 500
Termination condition: dlogZ < 0.1
Starting nested sampling...
Dead points: 0 dead points [00:00, ? dead points/s]Dead points: 500 dead points [00:16, 29.54 dead points/s]Dead points: 500 dead points [00:30, 29.54 dead points/s]Dead points: 1000 dead points [00:30, 33.06 dead points/s]Dead points: 1500 dead points [00:33, 51.78 dead points/s]Dead points: 2000 dead points [00:36, 71.80 dead points/s]Dead points: 2500 dead points [00:40, 86.92 dead points/s]Dead points: 3000 dead points [00:46, 86.73 dead points/s]Dead points: 3500 dead points [00:54, 74.54 dead points/s]Dead points: 4000 dead points [01:09, 54.47 dead points/s]Dead points: 4000 dead points [01:20, 54.47 dead points/s]Dead points: 4500 dead points [01:29, 39.49 dead points/s]Dead points: 4500 dead points [01:40, 39.49 dead points/s]Dead points: 5000 dead points [01:49, 33.23 dead points/s]Dead points: 5000 dead points [02:00, 33.23 dead points/s]Dead points: 5500 dead points [02:05, 32.70 dead points/s]Dead points: 5500 dead points [02:20, 32.70 dead points/s]Dead points: 6000 dead points [02:24, 30.55 dead points/s]Dead points: 6500 dead points [02:33, 35.62 dead points/s]Dead points: 7000 dead points [02:40, 41.77 dead points/s]Dead points: 7500 dead points [02:47, 47.66 dead points/s]Dead points: 8000 dead points [02:54, 53.25 dead points/s]Dead points: 8500 dead points [03:00, 60.18 dead points/s]Dead points: 9000 dead points [03:05, 68.10 dead points/s]Dead points: 9500 dead points [03:09, 77.04 dead points/s]Dead points: 10000 dead points [03:13, 86.73 dead points/s]Dead points: 10500 dead points [03:18, 93.97 dead points/s]Dead points: 11000 dead points [03:22, 97.27 dead points/s]Dead points: 11500 dead points [03:27, 98.56 dead points/s]Dead points: 12000 dead points [03:33, 96.84 dead points/s]Dead points: 12500 dead points [03:38, 94.44 dead points/s]Dead points: 13000 dead points [03:44, 92.74 dead points/s]Dead points: 13500 dead points [03:50, 91.11 dead points/s]Dead points: 14000 dead points [03:55, 89.84 dead points/s]Dead points: 14500 dead points [04:01, 89.05 dead points/s]Dead points: 15000 dead points [04:07, 89.10 dead points/s]Dead points: 15500 dead points [04:12, 90.22 dead points/s]Dead points: 16000 dead points [04:17, 91.23 dead points/s]Dead points: 16500 dead points [04:22, 93.95 dead points/s]Dead points: 17000 dead points [04:27, 96.06 dead points/s]Dead points: 17500 dead points [04:32, 98.57 dead points/s]Dead points: 18000 dead points [04:37, 101.24 dead points/s]Dead points: 18500 dead points [04:42, 101.61 dead points/s]Dead points: 19000 dead points [04:46, 104.80 dead points/s]Dead points: 19500 dead points [04:50, 109.51 dead points/s]Dead points: 20000 dead points [04:54, 114.13 dead points/s]Dead points: 20500 dead points [04:58, 118.46 dead points/s]Dead points: 21000 dead points [05:02, 120.37 dead points/s]Dead points: 21500 dead points [05:06, 119.98 dead points/s]Dead points: 22000 dead points [05:10, 118.31 dead points/s]Dead points: 22500 dead points [05:15, 119.05 dead points/s]Dead points: 23000 dead points [05:19, 117.50 dead points/s]Dead points: 23500 dead points [05:23, 117.64 dead points/s]Dead points: 24000 dead points [05:27, 118.03 dead points/s]Dead points: 24500 dead points [05:32, 118.57 dead points/s]Dead points: 25000 dead points [05:36, 115.99 dead points/s]Dead points: 25500 dead points [05:41, 110.74 dead points/s]Dead points: 26000 dead points [05:47, 103.64 dead points/s]Dead points: 26500 dead points [05:53, 96.76 dead points/s] Dead points: 27000 dead points [05:59, 90.74 dead points/s]Dead points: 27500 dead points [06:06, 83.62 dead points/s]Dead points: 28000 dead points [06:13, 78.26 dead points/s]Dead points: 28500 dead points [06:21, 72.28 dead points/s]Dead points: 29000 dead points [06:30, 66.97 dead points/s]Dead points: 29500 dead points [06:40, 62.43 dead points/s]Dead points: 30000 dead points [06:50, 56.39 dead points/s]Dead points: 30500 dead points [07:02, 51.49 dead points/s]Dead points: 31000 dead points [07:15, 46.87 dead points/s]Dead points: 31000 dead points [07:15, 71.19 dead points/s]
14:59 ninjax INFO    : Fetching the injected values for plotting
14:59 ninjax INFO    : Saving samples to ./samples.csv
14:59 ninjax INFO    : Saving metadata to ./metadata.json
14:59 ninjax INFO    : Time taken: 465.14129662513733 seconds (7.752354943752289 minutes)
14:59 ninjax INFO    : Creating the final corner plot
14:59 ninjax INFO    : Dumping the final production chains
14:59 ninjax INFO    : Chains shape is: (13, 1919)
14:59 ninjax INFO    : Finished successfully!

Nested sampling completed! Generated 31000 dead points.
Sampling time: 7 minutes 15.5 seconds

Finalizing nested sampling results...
Kish ESS = 5065.3

Transforming samples back to prior space...

Evidence: log(Z) = 857.29 Â± 0.23
DONE
