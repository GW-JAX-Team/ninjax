Mon Dec 15 15:36:57 CET 2025
NVIDIA H100
15:37 ninjax INFO    : Checking and setting outdir
15:37 ninjax INFO    : The outdir is set to .
15:37 ninjax INFO    : Loading the given config
15:37 ninjax INFO    : Arguments loaded into the config: {'likelihood': 'HeterodynedTransientLikelihoodFD', 'gw_injection': 'True', 'gw_load_existing_injection': 'True', 'gw_SNR_threshold_low': '20', 'gw_SNR_threshold_high': '50', 'gw_max_injection_attempts': '20', 'waveform_approximant': 'TaylorF2QM_taper', 'ifos': 'H1,L1,V1', 'eos_file': 'None', 'center_chirp_mass_prior': 'True', 'chirp_mass_prior_delta': '0.10', 'fmin': '20.0', 'fref': '20.0', 'fmax': '2048.0', 'duration': 'None', 'post_trigger_duration': '2.0', 'trigger_time': '1187008882.4', 'psd_file_H1': 'AplusDesign_PSD.txt', 'psd_file_L1': 'AplusDesign_PSD.txt', 'psd_file_V1': 'AdV_psd.txt', 'psd_file_ET1': '/home/twouters2/psds/ET_D_psd.txt', 'psd_file_ET2': '/home/twouters2/psds/ET_D_psd.txt', 'psd_file_ET3': '/home/twouters2/psds/ET_D_psd.txt', 'psd_file_CE': '/home/twouters2/psds/CE_psd.txt', 'data_file_H1': 'None', 'data_file_L1': 'None', 'data_file_V1': 'None', 'data_file_ET1': 'None', 'data_file_ET2': 'None', 'data_file_ET3': 'None', 'relative_binning_binsize': '500', 'relative_binning_ref_params_equal_true_params': 'True', 'relative_binning_ref_params': 'None', 'transforms': 'None', 'gw_kwargs': 'None', 'n_chains': '1000', 'n_local_steps': '500', 'n_global_steps': '1000', 'n_training_loops': '50', 'n_production_loops': '20', 'n_epochs': '50', 'mala_step_size': '1e-5', 'mala_step_size_scale': 'None', 'chain_batch_size': '0', 'batch_size': '5000', 'n_max_examples': '5000', 'rq_spline_hidden_units': '128,128', 'rq_spline_n_bins': '8', 'rq_spline_n_layers': '10', 'learning_rate': '0.001', 'local_thinning': '50', 'global_thinning': '100', 'n_NFproposal_batch_size': '100', 'history_window': '100', 'n_temperatures': '0', 'max_temperature': '10.0', 'n_tempered_steps': '5', 'verbose': 'False', 'save_training_chains': 'False', 'use_scheduler': 'False', 'seed': 'None', 'sampling_seed': '1', 'run_sampler': 'True', 'keys_to_plot': 'M_c, q, s1_z, s2_z, lambda_1, lambda_2, f_stop, a_1, a_2, d_L, t_c, phase_c, iota, psi, ra, dec', 'use_QM': 'False', 'use_f_stop': 'True'}
15:37 ninjax INFO    : Complete config file written to /gpfs/home1/mdrent/ninjax/examples/example_SSM_wStop/complete_config.json
15:37 ninjax INFO    : No seed specified. Generating a random seed: 237996
15:37 ninjax INFO    : Loading the priors
15:37 ninjax INFO    :    Mc_prior = UniformPrior(1.0, 2.2, parameter_names=['M_c'])
15:37 ninjax INFO    :    q_prior = UniformPrior(0.5, 1.0, parameter_names=['q'])
15:37 ninjax INFO    :    s1z_prior = UniformPrior(-0.05, 0.05, parameter_names=['s1_z'])
15:37 ninjax INFO    :    s2z_prior = UniformPrior(-0.05, 0.05, parameter_names=['s2_z'])
15:37 ninjax INFO    :    lambda_1_prior = UniformPrior(0.0, 5000.0, parameter_names=['lambda_1'])
15:37 ninjax INFO    :    lambda_2_prior = UniformPrior(0.0, 5000.0, parameter_names=['lambda_2'])
15:37 ninjax INFO    :    C1_prior = UniformPrior(0.01, 0.5, parameter_names=['C_1'])
15:37 ninjax INFO    :    C2_prior = UniformPrior(0.01, 0.5, parameter_names=['C_2'])
15:37 ninjax INFO    :    a1_prior = UniformPrior(0., 10., parameter_names=['a_1'])
15:37 ninjax INFO    :    a2_prior = UniformPrior(0., 10., parameter_names=['a_2'])
15:37 ninjax INFO    :    dL_prior = PowerLawPrior(1.0, 200.0, 2.0, parameter_names=['d_L'])
15:37 ninjax INFO    :    tc_prior = UniformPrior(-0.1, 0.1, parameter_names=['t_c'])
15:37 ninjax INFO    :    phase_c_prior = UniformPrior(0.0, 2 * jnp.pi, parameter_names=['phase_c'])
15:37 ninjax INFO    :    iota_prior = SinePrior(parameter_names=["iota"])
15:37 ninjax INFO    :    psi_prior = UniformPrior(0.0, jnp.pi, parameter_names=["psi"])
15:37 ninjax INFO    :    ra_prior = UniformPrior(0.0, 2 * jnp.pi, parameter_names=["ra"])
15:37 ninjax INFO    :    dec_prior = CosinePrior(parameter_names=["dec"])
15:37 ninjax INFO    : Finished prior setup
15:37 ninjax INFO    : Setting the transforms
15:37 ninjax INFO    : Built sample_transforms pipeline with 0 transforms
15:37 ninjax INFO    : Built likelihood_transforms pipeline with 2 transforms
15:37 ninjax INFO    : Setting the likelihood
15:37 ninjax INFO    : GW likelihood provided, setting up the GW pipe
15:37 ninjax INFO    : eos_file is None
15:37 ninjax INFO    : No eos_file specified. Will sample lambdas uniformly.
15:37 ninjax INFO    : GW run is an injection
15:37 ninjax INFO    : Setting up GW injection . . . 
15:37 ninjax INFO    : The SNR thresholds are: 20.0 - 50.0
15:37 ninjax INFO    : Maximum injection attempts allowed: 20
15:37 ninjax INFO    : Loading existing injection, path: ./injection.json
15:37 ninjax INFO    : Duration is not specified in the config. Computed chirp time: for fmin = 20.0 and M_c = 1.3023405409630757 is 256.0
15:37 ninjax INFO    : After transforms, the injection parameters are:
15:37 ninjax INFO    : {'M_c': 1.3023405409630757, 's1_z': 0.01, 's2_z': 0.01, 'lambda_1': 232.9613208692348, 'lambda_2': 520.598134087556, 'a_1': 0, 'a_2': 0, 'd_L': 120.0, 't_c': -0.05815957557656209, 'phase_c': 1.1644515460827842, 'iota': 0.8337374361881844, 'psi': 0.6902000288427731, 'ra': 5.446571919019908, 'dec': 0.93640500992398, 'H1_SNR': 25.23627687028645, 'L1_SNR': 17.408239438994038, 'V1_SNR': 8.314912418974657, 'network_SNR': 31.765614100380954, 'epoch': 254.0, 'gmst': 2.7288901910520846, 'trigger_time': 1187008882.4, 'duration': 256.0, 'eta': 0.24888888888888885, 'f_stop': Array(958.37307624, dtype=float64, weak_type=True)}
15:37 ninjax INFO    : The trial injection parameters are {'M_c': 1.3023405409630757, 's1_z': 0.01, 's2_z': 0.01, 'lambda_1': 232.9613208692348, 'lambda_2': 520.598134087556, 'a_1': 0.0, 'a_2': 0.0, 'd_L': 120.0, 't_c': -0.05815957557656209, 'phase_c': 1.1644515460827842, 'iota': 0.8337374361881844, 'psi': 0.6902000288427731, 'ra': 5.446571919019908, 'dec': 0.93640500992398, 'H1_SNR': 25.23627687028645, 'L1_SNR': 17.408239438994038, 'V1_SNR': 8.314912418974657, 'network_SNR': 31.765614100380954, 'epoch': 254.0, 'gmst': np.float64(2.7288901910520846), 'trigger_time': 1187008882.4, 'duration': 256.0, 'eta': 0.24888888888888885, 'f_stop': 958.3730762377536}
15:37 ninjax INFO    : Injecting signals . . .
15:37 ninjax INFO    : self.ifos
15:37 ninjax INFO    : [GroundBased2G(H1), GroundBased2G(L1), GroundBased2G(V1)]
15:37 ninjax INFO    : Loading PSD from file: /gpfs/home1/mdrent/ninjax/src/ninjax/AplusDesign_PSD.txt
15:37 ninjax INFO    : Signal injected in ifo H1. Frequencies, data, and PSD:
15:37 ninjax INFO    : [0.00000000e+00 3.90625000e-03 7.81250000e-03 ... 2.04799219e+03
 2.04799609e+03 2.04800000e+03]
15:37 ninjax INFO    : Data(name='H1_injected', delta_t=0.000244140625, epoch=254.0)
15:37 ninjax INFO    : PowerSpectrum(name='H1_psd', frequencies=[0.00000000e+00 3.90625000e-03 7.81250000e-03 ... 2.04799219e+03
 2.04799609e+03 2.04800000e+03])
15:37 ninjax INFO    : Loading PSD from file: /gpfs/home1/mdrent/ninjax/src/ninjax/AplusDesign_PSD.txt
15:37 ninjax INFO    : Signal injected in ifo L1. Frequencies, data, and PSD:
15:37 ninjax INFO    : [0.00000000e+00 3.90625000e-03 7.81250000e-03 ... 2.04799219e+03
 2.04799609e+03 2.04800000e+03]
15:37 ninjax INFO    : Data(name='L1_injected', delta_t=0.000244140625, epoch=254.0)
15:37 ninjax INFO    : PowerSpectrum(name='L1_psd', frequencies=[0.00000000e+00 3.90625000e-03 7.81250000e-03 ... 2.04799219e+03
 2.04799609e+03 2.04800000e+03])
15:37 ninjax INFO    : Loading PSD from file: /gpfs/home1/mdrent/ninjax/src/ninjax/AdV_psd.txt
15:37 ninjax INFO    : Signal injected in ifo V1. Frequencies, data, and PSD:
15:37 ninjax INFO    : [0.00000000e+00 3.90625000e-03 7.81250000e-03 ... 2.04799219e+03
 2.04799609e+03 2.04800000e+03]
15:37 ninjax INFO    : Data(name='V1_injected', delta_t=0.000244140625, epoch=254.0)
15:37 ninjax INFO    : PowerSpectrum(name='V1_psd', frequencies=[0.00000000e+00 3.90625000e-03 7.81250000e-03 ... 2.04799219e+03
 2.04799609e+03 2.04800000e+03])
15:37 ninjax INFO    : SNR for ifo H1 is 25.190013514921134
15:37 ninjax INFO    : SNR for ifo L1 is 17.376326507796215
15:37 ninjax INFO    : SNR for ifo V1 is 8.314356290252908
15:37 ninjax INFO    : The network SNR is 31.711228678635567
15:37 ninjax INFO    : Network SNR passes threshold
15:37 ninjax INFO    : Sanity checking the GW injection for ArrayImpl
15:37 ninjax INFO    :    M_c: 1.3023405409630757
15:37 ninjax INFO    :    q: 0.8749999999999999
15:37 ninjax INFO    :    s1_z: 0.01
15:37 ninjax INFO    :    s2_z: 0.01
15:37 ninjax INFO    :    lambda_1: 232.9613208692348
15:37 ninjax INFO    :    lambda_2: 520.598134087556
15:37 ninjax INFO    :    C_1: 0.33866705151612153
15:37 ninjax INFO    :    C_2: 0.4146678500014733
15:37 ninjax INFO    :    a_1: 0
15:37 ninjax INFO    :    a_2: 0
15:37 ninjax INFO    :    d_L: 120.0
15:37 ninjax INFO    :    t_c: -0.05815957557656209
15:37 ninjax INFO    :    phase_c: 1.1644515460827842
15:37 ninjax INFO    :    iota: 0.8337374361881844
15:37 ninjax INFO    :    psi: 0.6902000288427731
15:37 ninjax INFO    :    ra: 5.446571919019908
15:37 ninjax INFO    :    dec: 0.93640500992398
15:37 ninjax INFO    :    H1_SNR: 25.190013514921134
15:37 ninjax INFO    :    L1_SNR: 17.376326507796215
15:37 ninjax INFO    :    V1_SNR: 8.314356290252908
15:37 ninjax INFO    :    network_SNR: 31.711228678635567
15:37 ninjax INFO    :    epoch: 254.0
15:37 ninjax INFO    :    gmst: 2.7288901910520846
15:37 ninjax INFO    :    trigger_time: 1187008882.4
15:37 ninjax INFO    :    duration: 256.0
15:37 ninjax INFO    : Using GW HeterodynedTransientLikelihoodFD. Initializing likelihood
15:37 ninjax INFO    : Using the injection parameters as reference parameters for the relative binning
15:37 ninjax INFO    : Using the following kwargs for the GW likelihood: {}
15:37 ninjax INFO    : Applying likelihood transforms to reference parameters
15:37 ninjax INFO    : Transformed ref_params keys: ['M_c', 's1_z', 's2_z', 'lambda_1', 'lambda_2', 'a_1', 'a_2', 'd_L', 't_c', 'phase_c', 'iota', 'psi', 'ra', 'dec', 'H1_SNR', 'L1_SNR', 'V1_SNR', 'network_SNR', 'epoch', 'gmst', 'trigger_time', 'duration', 'eta', 'f_stop']
For detector H1, the injected signal has:
  - Optimal SNR: 25.1900
  - Match filtered SNR: 26.4245-1.4537j
For detector L1, the injected signal has:
  - Optimal SNR: 17.3763
  - Match filtered SNR: 18.4232+2.4859j
For detector V1, the injected signal has:
  - Optimal SNR: 8.3144
  - Match filtered SNR: 7.9716-0.1766j
PRIOR:  Combine(priors=[UniformPrior(xmin=1.0, xmax=2.2, parameter_names=['M_c']), UniformPrior(xmin=0.5, xmax=1.0, parameter_names=['q']), UniformPrior(xmin=-0.05, xmax=0.05, parameter_names=['s1_z']), UniformPrior(xmin=-0.05, xmax=0.05, parameter_names=['s2_z']), UniformPrior(xmin=0.0, xmax=5000.0, parameter_names=['lambda_1']), UniformPrior(xmin=0.0, xmax=5000.0, parameter_names=['lambda_2']), UniformPrior(xmin=0.01, xmax=0.5, parameter_names=['C_1']), UniformPrior(xmin=0.01, xmax=0.5, parameter_names=['C_2']), PowerLawPrior(xmin=1.0, xmax=200.0, alpha=2.0, naming=['d_L']), UniformPrior(xmin=-0.1, xmax=0.1, parameter_names=['t_c']), UniformPrior(xmin=0.0, xmax=6.283185307179586, parameter_names=['phase_c']), SinePrior(parameter_names=['iota']), UniformPrior(xmin=0.0, xmax=3.141592653589793, parameter_names=['psi']), UniformPrior(xmin=0.0, xmax=6.283185307179586, parameter_names=['ra']), CosinePrior(parameter_names=['dec'])], parameter_names=['M_c', 'q', 's1_z', 's2_z', 'lambda_1', 'lambda_2', 'C_1', 'C_2', 'd_L', 't_c', 'phase_c', 'iota', 'psi', 'ra', 'dec'])
FIXED PARAMS:  {'a_1': 0, 'a_2': 0}
Traceback (most recent call last):
  File "/home/mdrent/miniconda3/envs/Jim/bin/ninjax_analysis", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/gpfs/home1/mdrent/ninjax/src/ninjax/analysis.py", line 305, in main
    pipe = NinjaxPipe(config_filename)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home1/mdrent/ninjax/src/ninjax/pipes/ninjax_pipe.py", line 117, in __init__
    self.likelihood = self.set_original_likelihood(likelihood_str)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home1/mdrent/ninjax/src/ninjax/pipes/ninjax_pipe.py", line 492, in set_original_likelihood
    likelihood = HeterodynedTransientLikelihoodFD(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home1/mdrent/jim/src/jimgw/core/single_event/likelihood.py", line 526, in __init__
    A0, A1, B0, B1 = self.compute_coefficients(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home1/mdrent/jim/src/jimgw/core/single_event/likelihood.py", line 662, in compute_coefficients
    freq_shift_matrix = (
                        ^
  File "/home/mdrent/miniconda3/envs/Jim/lib/python3.11/site-packages/jax/_src/numpy/array_methods.py", line 604, in deferring_binary_op
    return binary_op(*args)
           ^^^^^^^^^^^^^^^^
  File "/home/mdrent/miniconda3/envs/Jim/lib/python3.11/site-packages/jax/_src/numpy/ufunc_api.py", line 183, in __call__
    return call(*args)
           ^^^^^^^^^^^
  File "/home/mdrent/miniconda3/envs/Jim/lib/python3.11/site-packages/jax/_src/numpy/ufuncs.py", line 1281, in multiply
    return lax.mul(x, y) if x.dtype != bool else lax.bitwise_and(x, y)
           ^^^^^^^^^^^^^
TypeError: mul got incompatible shapes for broadcasting: (385, 519169), (384, 519169).
--------------------
For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.
DONE
